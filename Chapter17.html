
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Shooting Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.1.1">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Chapter18.html" />
    
    
    <link rel="prev" href="Chapter15.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Chapter1.html">
            
                <a href="Chapter1.html">
            
                    
                    Starting Out
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="FrameworksSources.html">
            
                <a href="FrameworksSources.html">
            
                    
                    Managers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="Game.html">
            
                <a href="Game.html">
            
                    
                    Game
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="Program.html">
            
                <a href="Program.html">
            
                    
                    Program
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Chapter2.html">
            
                <a href="Chapter2.html">
            
                    
                    Why Tiles?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Chapter3.html">
            
                <a href="Chapter3.html">
            
                    
                    Map Format
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="Chapter6.html">
            
                <a href="Chapter6.html">
            
                    
                    Creating Tiles
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="Practice/PracticeCh6.html">
            
                <a href="Practice/PracticeCh6.html">
            
                    
                    On Your Own
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="Chapter5.html">
            
                <a href="Chapter5.html">
            
                    
                    Map Tools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="Chapter8.html">
            
                <a href="Chapter8.html">
            
                    
                    The Hero
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="Practice/PracticeTheHero.html">
            
                <a href="Practice/PracticeTheHero.html">
            
                    
                    On Your Own
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="Chapter9.html">
            
                <a href="Chapter9.html">
            
                    
                    Keys To Move
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="Practice/PracticeMoving.html">
            
                <a href="Practice/PracticeMoving.html">
            
                    
                    On Your Own
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="Chapter10.html">
            
                <a href="Chapter10.html">
            
                    
                    Hit The Wall
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="Chapter11.html">
            
                <a href="Chapter11.html">
            
                    
                    Open The Door
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="cleanup.html">
            
                <a href="cleanup.html">
            
                    
                    Cleaning Up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="borders.html">
            
                <a href="borders.html">
            
                    
                    Screen Borders
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="Chapter12.html">
            
                <a href="Chapter12.html">
            
                    
                    Jumping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="jumpconfig.html">
            
                <a href="jumpconfig.html">
            
                    
                    Configurable Jumping
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="Chapter13.html">
            
                <a href="Chapter13.html">
            
                    
                    Clouds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="Chapter15.html">
            
                <a href="Chapter15.html">
            
                    
                    Simple Enemy
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.14" data-path="Chapter17.html">
            
                <a href="Chapter17.html">
            
                    
                    Shooting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="Chapter18.html">
            
                <a href="Chapter18.html">
            
                    
                    Getting Items
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="Chapter20.html">
            
                <a href="Chapter20.html">
            
                    
                    Scrolling
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="Chapter21.html">
            
                <a href="Chapter21.html">
            
                    
                    Limit Scrolling
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="Chapter22.html">
            
                <a href="Chapter22.html">
            
                    
                    Depth
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="SpeerateCollisionAndRendering.html">
            
                <a href="SpeerateCollisionAndRendering.html">
            
                    
                    Collision & Rendering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.2" data-path="AddingAHouse.html">
            
                <a href="AddingAHouse.html">
            
                    
                    Visual Tweaks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.3" data-path="DepthBuffer.html">
            
                <a href="DepthBuffer.html">
            
                    
                    Depth Buffer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="Chapter23.html">
            
                <a href="Chapter23.html">
            
                    
                    Ismetric View
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="Iso_MakeMap.html">
            
                <a href="Iso_MakeMap.html">
            
                    
                    Map
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="Iso_MakeCharacters.html">
            
                <a href="Iso_MakeCharacters.html">
            
                    
                    Characters
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.3" data-path="Iso_MakeItems.html">
            
                <a href="Iso_MakeItems.html">
            
                    
                    Items & Projectiles
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="Chapter24.html">
            
                <a href="Chapter24.html">
            
                    
                    Mouse To Move
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="Chapter7.html">
            
                <a href="Chapter7.html">
            
                    
                    More Tiles
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Shooting</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="shooting">Shooting</h1>
<p>The enemies can kill the player, but the player can&apos;t kill the enemies. Doesn&apos;t seem very fair does it? Let&apos;s add a simple way for the player to kill an enemy. If during gameplay the player presses the sapce bar he will shoot a bullet that can kill the enemy.</p>
<p>The way to achieve this is actually pretty simple. We&apos;re going to implement a bullet class. Whenever space is pressed a bullet will be added to a list. Every frame we loop trough the list. If a bullet has hit a wall we remove it from the list. If a bullet has hit an enemy, we remove the bullet AND the enemy. Simple.</p>
<h3 id="new-project">New Project</h3>
<p>Let&apos;s make a new project, call it <strong>Shoting</strong> and get this project up to par with the <strong>SimpleEnemy</strong> section of the writeup. We&apos;re going to work from here.</p>
<h3 id="bullet-class">Bullet class</h3>
<p>Let&apos;s start by adding the new bullet class. This should be an easy one. Bullet has only two members, position and velocity. The update method of the class should apply the velocity to position over time. The render method should just draw a square around the point at which the bullet is. IF you want try to write this class without looking at the below code:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">class</span> <span class="hljs-title">Bullet</span> {
    <span class="hljs-keyword">public</span> PointF Position = <span class="hljs-keyword">new</span> PointF(<span class="hljs-number">0.0</span>f, <span class="hljs-number">0.0</span>f);
    <span class="hljs-keyword">public</span> PointF Velocity = <span class="hljs-keyword">new</span> PointF(<span class="hljs-number">0.0</span>f, <span class="hljs-number">0.0</span>f);

    <span class="hljs-comment">// Eventually everything that renders as a square </span>
    <span class="hljs-comment">// is going to ned access to its area. Adding a Rect </span>
    <span class="hljs-comment">// getter is a good habit to get into</span>
    <span class="hljs-keyword">public</span> Rectangle Rect {
        <span class="hljs-keyword">get</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Rectangle( (<span class="hljs-keyword">int</span>)Position.X - <span class="hljs-number">5</span>, (<span class="hljs-keyword">int</span>)Position.Y - <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span> );
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Bullet</span>(<span class="hljs-params">PointF pos, PointF vel</span>) </span>{
        Position = pos;
        Velocity = vel;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Update</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> deltaTime</span>) </span>{
        Position.X += Velocity.X * deltaTime;
        Position.Y += Velocity.Y * deltaTime;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Render</span>(<span class="hljs-params"></span>) </span>{
        Rectangle renderRect = <span class="hljs-keyword">new</span> Rectangle(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);
        renderRect.X = (<span class="hljs-keyword">int</span>)(Position.X - <span class="hljs-number">5</span>f);
        renderRect.Y = (<span class="hljs-keyword">int</span>)(Position.Y - <span class="hljs-number">5</span>f);

        GraphicsManager.Instance.DrawRect(renderRect, Color.Red);
    }
}
</code></pre>
<h3 id="game-refactor">Game Refactor</h3>
<p>To actually shoot / use bullets we need to refactor the <strong>Game</strong> class a little bit. First thing is first, add a new member variable, let&apos;s call it <strong>projectiles</strong> its type is going to be <code>List&lt;Bullet&gt;</code>, don&apos;t forget to initialize this new list.</p>
<p>In the <strong>Render</strong> function, after rendering the hero, but before rendering the game over screen, loop trough every projectile in projectiles and call render on all of them.</p>
<p>In the <strong>Update</strong> method, after updating the hero, but before updating the map, loop trough all theprojectiles and call <code>Update</code> on each of them, passing in deltaTime. </p>
<p>At this point we still can&apos;t see anything on screen. We need to add some code to actually shoot the projectile. Above the loop that updates all the projectiles, add an if statement. In this if statement check if the space key was pressed. If it was, use the hero objects <code>currentSprite</code> variable to determine which direction the velocity needs to face. Velocity should be either 90, or -90, that is 3 tiles per second. </p>
<p>Once you know which way the velocity goes, add a new bullet at the center of the player. Like so:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">if</span> (InputManager.Instance.KeyPressed(OpenTK.Input.Key.Space)<span class="hljs-number">3</span>) {
    PointF velocity = <span class="hljs-keyword">new</span> PointF(<span class="hljs-number">0.0</span>f, <span class="hljs-number">0.0</span>f);
    <span class="hljs-keyword">if</span> (hero.currentSprite == <span class="hljs-string">&quot;down&quot;</span>) {
        velocity.Y = <span class="hljs-number">100</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> (<span class="hljs-params">hero.currentSprite == <span class="hljs-string">&quot;up&quot;</span></span>) </span>{
        velocity.Y = <span class="hljs-number">-100</span>;
    }
    <span class="hljs-keyword">if</span> (hero.currentSprite == <span class="hljs-string">&quot;left&quot;</span>) {
        velocity.X = <span class="hljs-number">-100</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> (<span class="hljs-params">hero.currentSprite == <span class="hljs-string">&quot;right&quot;</span></span>) </span>{
        velocity.X = <span class="hljs-number">100</span>;
    }
    <span class="hljs-comment">// projectiles is the name of my member variable that is of type List&lt;Bullet&gt;</span>
    projectiles.Add(<span class="hljs-keyword">new</span> Bullet(hero.Center, velocity));
}
</code></pre>
<p><strong>Run the game</strong>, every time you press space there shoudl be a new projectile. Each projectile shoots, and eventually makes it off-screen. You may have notices that we don&apos;t have a Destroy function for the projectiles, that&apos;s because they don&apos;t need a Destroy function. The projectiles just draw squares, if no texture / resources are being held onto then a resource class is useless.</p>
<h3 id="map-refactor">Map Refactor</h3>
<p>Becuse the <strong>Map</strong> class knows about both walkable / non-walkable tiles AND enemies, it seems as good a place as any to add logic that will make bullets dissapear. There are two instances where bullets will dissapear, if they hit a non walkable tile; or if they hit an enemy.</p>
<p>Inside the <strong>Update</strong>method of the ``map<code>class. Add a new artument. A</code>List<bullet><code>, call this argument</code>projectiles```. You want to loop trough this array before looping trough the enemies array. Remember, you are going to be removing items for the array, loop accordinly.</bullet></p>
<p>Inside this loop:</p>
<ul>
<li>Find the xTile of the projectile</li>
<li>Fint the yTile of the projectile</li>
<li>If the xTile is out of bounds<ul>
<li>remove the loop index (i?) from the projectiles array.</li>
</ul>
</li>
<li>ELSE If the yTile is out of bounds<ul>
<li>remove the loop index (i?) from the projectiles array.</li>
</ul>
</li>
<li>ELSE If the tile at [yTile][xTile] is not Walkable<ul>
<li>remove the loop index (i?) from the projectiles array. </li>
</ul>
</li>
</ul>
<p>Remember, you can use the <code>RemoveAt</code> function of a vector to remove an item at a specific location. Next, let&apos;s update the way you check for enemu collision. Right now you have a loop counting up. Make this loop count down, we are going to potentially be deleting specific enemies from the <code>enemies</code> array.</p>
<p>This next bit can get tricky. After the game over check, loop trough all the projectiles. You probably want to loop in reverse, we might remove things from this array.. For every projectile, see if it intersects with the current enemy. If it does, remove the enemy, and remove the projectile.</p>
<p><strong>Hint</strong>, at this point the game might break. That is because even tough the enemy was removed we might still be checking for collision against the projectiles for the removed enemy. Therefore when a projectile and enemy collide, break out of the inner (j) loop.</p>
<h3 id="thats-it">That&apos;s it!</h3>
<p><strong>Run the game</strong> you are now a bad-ass who can walk around and shoot monsters just for the fun of it!</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Chapter15.html" class="navigation navigation-prev " aria-label="Previous page: Simple Enemy">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Chapter18.html" class="navigation navigation-next " aria-label="Next page: Getting Items">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Shooting","level":"1.14","depth":1,"next":{"title":"Getting Items","level":"1.15","depth":1,"path":"Chapter18.md","ref":"Chapter18.md","articles":[]},"previous":{"title":"Simple Enemy","level":"1.13","depth":1,"path":"Chapter15.md","ref":"Chapter15.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"letter","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Chapter17.md","mtime":"2016-07-09T03:24:55.786Z","type":"markdown"},"gitbook":{"version":"3.1.1","time":"2016-10-03T18:07:37.300Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

